import{u as d,r,j as t,A as L,U as O,a as P,P as g,L as D}from"./index-eH9Ow_gZ.js";import{u as V,N as C,b as M,S as w,A as $}from"./Navigation-ehB0_QEx.js";import{B as F,F as S,b as H,c as R}from"./index.es-p3vlnadu.js";import{I as Y}from"./Input-cUco2cyQ.js";const z="_container_1y6oh_3",K="_link_1y6oh_12",T="_sidebar_1y6oh_26",l={container:z,link:K,sidebar:T},q="_content_1n2c1_3",G="_username_1n2c1_7",_={content:q,username:G},J=()=>{var U,p,x;const{state:s,dispatch:a}=d(),[n,c]=r.useState(!1),[i,o]=r.useState(((U=s.currentUser)==null?void 0:U.username)||""),[u,m]=r.useState(!1),[v,f]=r.useState("");r.useEffect(()=>{const e=B=>{var j;B.key==="Escape"&&(c(!1),o(((j=s.currentUser)==null?void 0:j.username)||""))};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[s.currentUser]);const A=e=>{o(e),y(e)},y=e=>{o(e),e.length>=3?(m(!0),f(` (You are good to go ${e}!ðŸ˜‰)`)):(m(!1),f(" (Oops! at least 3 characters.ðŸ˜…)"))},h=()=>{var e;u&&i&&(a({type:L.ADD_USER,payload:{id:((e=s.currentUser)==null?void 0:e.id)||0,isOnline:!0,username:i.trim(),status:O.AVAILABLE,lastSeenAt:new Date().toISOString()}}),c(!1))},b=()=>c(!n),k=e=>{e.preventDefault(),n?h():b()},I=()=>{var e;i!==((e=s.currentUser)==null?void 0:e.username)||u?h():N()},N=()=>{var e;c(!1),o(((e=s.currentUser)==null?void 0:e.username)||"")};return t.jsxs("h1",{className:_.username,children:[n?t.jsx(Y,{id:"username",placeholder:"Username",defaultValue:(x=s.currentUser)==null?void 0:x.username,onValueChange:A,withValidation:!0,value:i,message:v,onBlur:I}):(p=s.currentUser)==null?void 0:p.username,t.jsx(F,{id:"edit-username",onClick:k,type:"button",className:"icon",isEnabled:!n||u,children:t.jsx(S,{icon:n?R:H})})]})},E=()=>{var a,n;const{state:s}=d();return t.jsxs("div",{className:_.content,children:[t.jsx(J,{}),t.jsx("p",{children:(a=s.currentUser)==null?void 0:a.status}),t.jsx("p",{children:((n=s.currentUser)==null?void 0:n.lastSeenAt)&&`Seen at: ${new Date(s.currentUser.lastSeenAt).toLocaleDateString()}`})]})};function ee(){const{state:s}=d(),a=P(),n=V();return r.useEffect(()=>{s.currentUser||a(g.HOME)},[a,s.currentUser]),t.jsxs("div",{className:l.container,"data-testid":"lobby",children:[t.jsx(C,{children:t.jsx("li",{children:t.jsx(D,{to:g.LOBBY,className:l.link,children:t.jsx(S,{icon:M})})})}),t.jsxs(w,{title:"",children:[t.jsx("div",{className:l.sidebar,children:s.currentUser&&t.jsx($,{username:s.currentUser.username,size:"large",status:s.currentUser.status,isOnline:s.currentUser.isOnline})}),!n&&t.jsx(E,{})]}),n&&t.jsx(E,{})]})}export{ee as default};
